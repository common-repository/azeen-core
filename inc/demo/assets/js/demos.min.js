(function(b){b(document).ready(function(){a.init()});var a={importData:{},allowPopupClosing:true,init:function(){var c=this;this.categoriesFilter();b(".fwp-search-input").on("keyup",function(){if(0<b(this).val().length){b(".fwp-demo-wrap .themes").find(".theme-wrap").hide();b(".fwp-demo-wrap .themes").find('.theme-wrap[data-name*="'+b(this).val().toLowerCase()+'"]').show()}else{b(".fwp-demo-wrap .themes").find(".theme-wrap").show()}});b(".fwp-demo-wrap .theme-actions a.button").on("click",function(d){d.stopPropagation()});b(".fwp-open-popup").click(function(h){h.preventDefault();var d=b(this).data("demo-id"),g=b(".preview-"+d),f=b(".preview-all-"+d);g.show();f.show();c.getDemoData(d)});b(document).on("click",".install-now",this.installNow);b(document).on("click",".activate-now",this.activatePlugins);b(document).on("wp-plugin-install-success",this.installSuccess);b(document).on("wp-plugin-installing",this.pluginInstalling);b(document).on("wp-plugin-install-error",this.installError)},categoriesFilter:function(){var i=b(".fwp-demo-wrap .themes").find(".theme-wrap"),h="fwp-is-fadeout",g="fwp-is-fadein",f=200;var e=function(){var j=b.Deferred();i.addClass(h);setTimeout(function(){i.removeClass(h).hide();j.resolve()},f);return j.promise()};var c=function(l,j){var k=l?'[data-categories*="'+l+'"]':"div";if("all"===l){k="div"}i.filter(k).show().addClass("fwp-is-fadein");setTimeout(function(){i.removeClass(g);j.resolve()},f)};var d=function(k){var j=b.Deferred();var l=e();l.done(function(){c(k,j)});return j};b(".fwp-navigation-link").on("click",function(k){k.preventDefault();b(this).parent().siblings().removeClass("active");b(this).parent().addClass("active");var j=this.hash.slice(1);var m=b(".fwp-demo-wrap .themes");m.css("min-width",m.outerHeight());var l=d(j);l.done(function(){m.removeAttr("style")})})},getDemoData:function(d){var c=this;b.ajax({url:azeenDemos.ajaxurl,type:"get",data:{action:"azeen_ajax_get_import_data",demo_name:d,security:azeenDemos.azeen_import_data_nonce},complete:function(e){c.importData=b.parseJSON(e.responseText)}});b.ajax({url:azeenDemos.ajaxurl,type:"get",data:{action:"azeen_ajax_get_demo_data",demo_name:d,demo_data_nonce:azeenDemos.demo_data_nonce},complete:function(f){c.runPopup(f);var g=b(".preview-"+d),e=b(".preview-all-"+d);g.hide();e.hide()}})},runPopup:function(f){var e=this;var c=b("html").innerWidth();b("html").css("overflow","hidden");var d=b("html").innerWidth();b("html").css("margin-right",d-c);b("#fwp-demo-popup-wrap").fadeIn();b(f.responseText).appendTo(b("#fwp-demo-popup-content"));b(".fwp-demo-popup-close, .fwp-demo-popup-overlay").on("click",function(g){g.preventDefault();if(e.allowPopupClosing===true){e.closePopup()}});b(".fwp-plugins-next").on("click",function(g){g.preventDefault();b("#fwp-demo-plugins").hide();b("#fwp-demo-import-form").show()});b("#fwp-demo-import-form").submit(function(i){i.preventDefault();var h=b(this).find('[name="azeen_import_demo"]').val(),g=b(this).find('[name="azeen_import_demo_data_nonce"]').val(),j=[];b(this).find('input[type="checkbox"]').each(function(){if(b(this).is(":checked")===true){j.push(b(this).attr("name"))}});b(this).hide();b(".fwp-loader").show();e.importContent({demo:h,nonce:g,contentToImport:j,isXML:b("#azeen_import_xml").is(":checked")})})},importContent:function(k){var f=this,h,i,d=Date.now(),c={azeen_import_demo:k.demo,azeen_import_demo_data_nonce:k.nonce};this.allowPopupClosing=false;b(".fwp-demo-popup-close").fadeOut();if(k.contentToImport.length===0){setTimeout(function(){b(".fwp-loader").hide();b(".fwp-last").show()},1000);b.ajax({url:azeenDemos.ajaxurl,type:"post",data:{action:"azeen_after_import",azeen_import_demo:k.demo,azeen_import_demo_data_nonce:k.nonce,azeen_import_is_xml:k.isXML},complete:function(l){}});this.allowPopupClosing=true;b(".fwp-demo-popup-close").fadeIn();return}for(var j in this.importData){var e=b.inArray(this.importData[j]["input_name"],k.contentToImport);if(e!==-1){h=j;k.contentToImport.splice(e,1);c.action=this.importData[j]["action"];break}}b(".fwp-import-status").append('<p class="fwp-importing">'+this.importData[h]["loader"]+"</p>");var g=b.ajax({url:azeenDemos.ajaxurl,type:"post",data:c,complete:function(o){clearTimeout(i);var n=true;if(o.status===500||o.status===502||o.status===503){b(".fwp-importing").addClass("fwp-importing-failed").removeClass("fwp-importing").text(azeenDemos.content_importing_error+" "+o.status)}else{if(o.responseText.indexOf("successful import")!==-1){b(".fwp-importing").addClass("fwp-imported").removeClass("fwp-importing")}else{var p=b.parseJSON(o.responseText),m="";for(var l in p){m+=p[l];if(l==="xml_import_error"){n=false}}b(".fwp-importing").addClass("fwp-importing-failed").removeClass("fwp-importing").text(m);f.allowPopupClosing=true;b(".fwp-demo-popup-close").fadeIn()}}if(n===true){f.importContent(k)}}});i=setTimeout(function(){g.abort();f.allowPopupClosing=true;b(".fwp-demo-popup-close").fadeIn();b(".fwp-importing").addClass("fwp-importing-failed").removeClass("fwp-importing").text(azeenDemos.content_importing_error)},15*60*1000)},closePopup:function(){b("html").css({overflow:"","margin-right":""});b(".preview-icon").hide();b(".preview-all").hide();b("#fwp-demo-popup-wrap").fadeOut();setTimeout(function(){b("#fwp-demo-popup-content").html("")},600)},installNow:function(d){d.preventDefault();var c=b(d.target),f=b(document);if(c.hasClass("updating-message")||c.hasClass("button-disabled")){return}if(wp.updates.shouldRequestFilesystemCredentials&&!wp.updates.ajaxLocked){wp.updates.requestFilesystemCredentials(d);f.on("credential-modal-cancel",function(){var e=b(".install-now.updating-message");e.removeClass("updating-message").text(wp.updates.l10n.installNow);wp.a11y.speak(wp.updates.l10n.updateCancel,"polite")})}wp.updates.installPlugin({slug:c.data("slug")})},activatePlugins:function(f){f.preventDefault();var d=b(f.target),c=d.data("init"),g=d.data("slug");if(d.hasClass("updating-message")||d.hasClass("button-disabled")){return}d.addClass("updating-message button-primary").html(azeenDemos.button_activating);b.ajax({url:azeenDemos.ajaxurl,type:"POST",data:{action:"azeen_ajax_required_plugins_activate",init:c,},}).done(function(e){if(e.success){d.removeClass("button-primary install-now activate-now updating-message").attr("disabled","disabled").addClass("disabled").text(azeenDemos.button_active)}})},installSuccess:function(g,c){g.preventDefault();var d=b(".fwp-plugin-"+c.slug).find(".button");var f=d.data("init");d.removeClass("install-now installed button-disabled updated-message").addClass("updating-message").html(azeenDemos.button_activating);setTimeout(function(){b.ajax({url:azeenDemos.ajaxurl,type:"POST",data:{action:"azeen_ajax_required_plugins_activate",init:f,},}).done(function(e){if(e.success){d.removeClass("button-primary install-now activate-now updating-message").attr("disabled","disabled").addClass("disabled").text(azeenDemos.button_active)}else{d.removeClass("updating-message")}})},1200)},pluginInstalling:function(f,c){f.preventDefault();var g=b(".fwp-plugin-"+c.slug),d=g.find(".button");d.addClass("updating-message")},installError:function(d,c){d.preventDefault();var f=b(".fwp-plugin-"+c.slug);f.removeClass("button-primary").addClass("disabled").html(wp.updates.l10n.installFailedShort)}}})(jQuery);